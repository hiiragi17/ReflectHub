# [EPIC] LINEé€£æºå®Ÿè£… ãƒ•ã‚§ãƒ¼ã‚º2

**Type**: Epic
**Priority**: High
**Phase**: Phase 2
**Timeline**: Week 1-2
**Status**: Ready for Implementation

## ğŸ¯ ç›®æ¨™

ReflectHubã«LINEé€£æºæ©Ÿèƒ½ã‚’å®Œå…¨ã«å®Ÿè£…ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒLINEçµŒç”±ã§æŒ¯ã‚Šè¿”ã‚Šãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’å—ã‘å–ã‚Šã€ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«æŒ¯ã‚Šè¿”ã‚Šã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

## ğŸ“‹ æ¦‚è¦

ã“ã®Epicã¯ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã§æ§‹æˆã•ã‚Œã¾ã™ï¼š

### Day 8: LINEåŸºç›¤è¨­å®šæ—¥
- **Task 4.1**: LINE Developersç’°å¢ƒæ§‹ç¯‰ (2æ™‚é–“)
- **Task 4.2**: é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (2æ™‚é–“)

### Day 9: LINE Loginå®Ÿè£…æ—¥
- **Task 4.3**: LINE Loginèªè¨¼ãƒ•ãƒ­ãƒ¼ (3æ™‚é–“)
- **Task 4.4**: WebhookåŸºç›¤å®Ÿè£… (2æ™‚é–“)

### Day 10: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ©Ÿèƒ½æ—¥
- **Task 4.5**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ©Ÿèƒ½å®Ÿè£… (4æ™‚é–“)

### Day 11: ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼
- **Task 4.6**: ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼å®Ÿè£… (4æ™‚é–“)
- **Task 4.7**: ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼åŸºç›¤å®Ÿè£… (4æ™‚é–“)

**Total**: 23æ™‚é–“

## ğŸ¨ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
LINE Platform
    â”œâ”€â”€ Messaging API
    â”œâ”€â”€ Login Channel
    â””â”€â”€ Rich Menu

         â†“

ReflectHub Backend (Next.js)
    â”œâ”€â”€ API Routes
    â”‚   â”œâ”€â”€ /api/line/webhook
    â”‚   â”œâ”€â”€ /api/auth/line/callback
    â”‚   â”œâ”€â”€ /api/settings/reminder
    â”‚   â””â”€â”€ /api/cron/reminders
    â””â”€â”€ Line Integration Layer
        â”œâ”€â”€ lib/line/client.ts
        â”œâ”€â”€ lib/line/webhook.ts
        â”œâ”€â”€ lib/line/messaging.ts
        â”œâ”€â”€ lib/line/auth.ts
        â””â”€â”€ lib/line/types.ts

         â†“

Supabase
    â”œâ”€â”€ profiles (æ‹¡å¼µ)
    â”œâ”€â”€ user_settings (æ–°è¦)
    â”œâ”€â”€ line_message_logs (æ–°è¦)
    â””â”€â”€ line_rich_menu (æ–°è¦)
```

## ğŸ“Š æˆåŠŸåŸºæº–

### æ©Ÿèƒ½æ€§
- [x] LINE Messaging APIã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯å—ä¿¡
- [x] LINE Loginã«ã‚ˆã‚‹èªè¨¼ãƒ•ãƒ­ãƒ¼
- [x] ãƒ†ã‚­ã‚¹ãƒˆãƒ»Flexãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€å—ä¿¡
- [x] ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º
- [x] ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è‡ªå‹•é€ä¿¡

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- [x] Webhookç½²åæ¤œè¨¼
- [x] OAuth2 Stateæ¤œè¨¼
- [x] ç§˜å¯†æƒ…å ±ã®ç’°å¢ƒå¤‰æ•°ç®¡ç†
- [x] ã‚¨ãƒ©ãƒ¼è©³ç´°ã®éè¡¨ç¤º

### ãƒ†ã‚¹ãƒˆ
- [x] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- [x] çµ±åˆãƒ†ã‚¹ãƒˆ
- [x] E2Eãƒ†ã‚¹ãƒˆ
- [x] æ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼ˆngrokï¼‰

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [x] APIä»•æ§˜æ›¸
- [x] å®Ÿè£…ã‚¬ã‚¤ãƒ‰
- [x] ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

## ğŸ”— é–¢é€£ã™ã‚‹Issue

ã™ã¹ã¦ã®ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã¯ä¸‹è¨˜ã®issueã§è¿½è·¡ã•ã‚Œã¾ã™ï¼š

1. **Issue**: Task 4.1 - LINE Developersç’°å¢ƒæ§‹ç¯‰
2. **Issue**: Task 4.2 - é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
3. **Issue**: Task 4.3 - LINE Loginèªè¨¼ãƒ•ãƒ­ãƒ¼
4. **Issue**: Task 4.4 - WebhookåŸºç›¤å®Ÿè£…
5. **Issue**: Task 4.5 - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ©Ÿèƒ½
6. **Issue**: Task 4.6 - ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼å®Ÿè£…
7. **Issue**: Task 4.7 - ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼åŸºç›¤å®Ÿè£…

## ğŸ“ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ã™ã¹ã¦ã®ã‚µãƒ–ã‚¿ã‚¹ã‚¯å®Œäº†
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆåˆæ ¼
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆåˆæ ¼
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆæ ¼
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå®Œäº†
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

## ğŸ“š å‚è€ƒè³‡æ–™

- [LINEé€£æºå®Ÿè£… è©³ç´°è¨­è¨ˆæ›¸](../LINE_INTEGRATION_DESIGN.md)
- [LINE Messaging API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.line.biz/ja/docs/messaging-api/)
- [LINE Login ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.line.biz/ja/docs/line-login/)

---

**Label**: `enhancement`, `line-integration`, `epic`
**Assignee**: @hiiragi17
**Start Date**: 2025-11-18
**End Date**: 2025-12-02
